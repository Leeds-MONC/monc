###
###
### SCRIPT TO READ IN ASCOS RADIOSONDE DATA AND OUTPUT FOR MONC
###
###

from __future__ import print_function
import time
import datetime
import numpy as np
import pandas as pd
from netCDF4 import Dataset
import numpy as np
import cartopy.crs as ccrs
import iris
import matplotlib.pyplot as plt
import matplotlib.cm as mpl_cm
import os
import seaborn as sns

#### import python functions
import sys
sys.path.insert(1, '../py_functions/')
from time_functions import calcTime_Mat2DOY, calcTime_Date2DOY
from readMAT import readMatlabStruct, readMatlabData
from physFuncts import calcThetaE, calcThetaVL
from pyFixes import py3_FixNPLoad

def quicklooksSonde(data, sondenumber):

    '''
    Notes from Tom's readme:
    Each sounding is in the Xdate_time_EDT variables. The data is organized such that column 7
    is the altitude, 3 is temperature, 4 is relative humidity, 10 is specific humidity, 12 is
    wind speed, and the rest you can probably figure out by looking at the variables. Some of
    them makes no sense at all; this is a quick monitiring file generated by the sounding
    system.

    There is also a variable named "sond" which is interpolated to same heights (in height). In
    that is also 13=potential temperature and 14=equivalent potential temperature. Time is the
    nominal times (00, 06, 12 etc UTC). The actual times are in the log file.
    '''

    SMALL_SIZE = 12
    MED_SIZE = 14
    LARGE_SIZE = 16

    plt.rc('font',size=MED_SIZE)
    plt.rc('axes',titlesize=MED_SIZE)
    plt.rc('axes',labelsize=MED_SIZE)
    plt.rc('xtick',labelsize=MED_SIZE)
    plt.rc('ytick',labelsize=MED_SIZE)
    plt.figure(figsize=(12,5))
    plt.rc('legend',fontsize=MED_SIZE)
    plt.subplots_adjust(top = 0.9, bottom = 0.12, right = 0.92, left = 0.1,
            hspace = 0.22, wspace = 0.4)

    yylim = 2.4e3

    plt.subplot(131)
    plt.plot(data['sonde'][:,2], data['sonde'][:,6])
    plt.ylabel('Z [m]')
    plt.xlabel('Temperature [K]')
    plt.ylim([0,yylim])
    plt.xlim([265,276])

    plt.subplot(132)
    plt.plot(data['sonde'][:,9], data['sonde'][:,6])
    plt.xlabel('Spec. Hum. [g/kg]')
    plt.ylim([0,yylim])

    plt.subplot(133)
    plt.plot(data['sonde'][:,3], data['sonde'][:,6])
    plt.xlabel('Rel. Hum. [%]')
    plt.ylim([0,yylim])

    plt.savefig('../FIGS/Quicklooks_' + sondenumber + '.png')
    plt.show()


def LEM_Load(data, sondenumber):

    '''
    Data copied from gillian/LEM/tom_arc1/morr2712/NAMELIST/nmlFORCE_ASCOS1
    '''

      # ZNREF_READ(1)=0,THREF_READ(1)=269.2,
      # ZNREF_READ(2)=2.5,THREF_READ(2)=269.2029,
      # ZNREF_READ(3)=7.5,THREF_READ(3)=269.2059,
      # ZNREF_READ(4)=12.5,THREF_READ(4)=269.209,
      # ZNREF_READ(5)=17.5,THREF_READ(5)=269.2124,
      # ZNREF_READ(6)=22.5,THREF_READ(6)=269.216,
      # ZNREF_READ(7)=27.5,THREF_READ(7)=269.22,
      # ZNREF_READ(8)=32.5,THREF_READ(8)=269.2244,
      # ZNREF_READ(9)=37.5,THREF_READ(9)=269.2293,
      # ZNREF_READ(10)=42.5,THREF_READ(10)=269.2348,
      # ZNREF_READ(11)=47.5,THREF_READ(11)=269.241,
      # ZNREF_READ(12)=52.5,THREF_READ(12)=269.2479,
      # ZNREF_READ(13)=57.5,THREF_READ(13)=269.2556,
      # ZNREF_READ(14)=62.5,THREF_READ(14)=269.2642,
      # ZNREF_READ(15)=67.5,THREF_READ(15)=269.2736,
      # ZNREF_READ(16)=72.5,THREF_READ(16)=269.2841,
      # ZNREF_READ(17)=77.5,THREF_READ(17)=269.2956,
      # ZNREF_READ(18)=82.5,THREF_READ(18)=269.3083,
      # ZNREF_READ(19)=87.5,THREF_READ(19)=269.322,
      # ZNREF_READ(20)=92.5,THREF_READ(20)=269.3369,
      # ZNREF_READ(21)=97.5,THREF_READ(21)=269.3531,
      # ZNREF_READ(22)=102.5,THREF_READ(22)=269.3704,
      # ZNREF_READ(23)=107.5,THREF_READ(23)=269.3889,
      # ZNREF_READ(24)=112.5,THREF_READ(24)=269.4086,
      # ZNREF_READ(25)=117.5,THREF_READ(25)=269.4295,
      # ZNREF_READ(26)=122.5,THREF_READ(26)=269.4514,
      # ZNREF_READ(27)=127.5,THREF_READ(27)=269.4745,
      # ZNREF_READ(28)=132.5,THREF_READ(28)=269.4986,
      # ZNREF_READ(29)=137.5,THREF_READ(29)=269.5235,
      # ZNREF_READ(30)=142.5,THREF_READ(30)=269.5493,
      # ZNREF_READ(31)=147.5,THREF_READ(31)=269.5759,
      # ZNREF_READ(32)=152.5,THREF_READ(32)=269.603,
      # ZNREF_READ(33)=157.5,THREF_READ(33)=269.6307,
      # ZNREF_READ(34)=162.5,THREF_READ(34)=269.6587,
      # ZNREF_READ(35)=167.5,THREF_READ(35)=269.687,
      # ZNREF_READ(36)=172.5,THREF_READ(36)=269.7154,
      # ZNREF_READ(37)=177.5,THREF_READ(37)=269.7437,
      # ZNREF_READ(38)=182.5,THREF_READ(38)=269.7719,
      # ZNREF_READ(39)=187.5,THREF_READ(39)=269.7998,
      # ZNREF_READ(40)=192.5,THREF_READ(40)=269.8273,
      # ZNREF_READ(41)=197.5,THREF_READ(41)=269.8543,
      # ZNREF_READ(42)=202.5,THREF_READ(42)=269.8807,
      # ZNREF_READ(43)=207.5,THREF_READ(43)=269.9063,
      # ZNREF_READ(44)=212.5,THREF_READ(44)=269.9311,
      # ZNREF_READ(45)=217.5,THREF_READ(45)=269.9551,
      # ZNREF_READ(46)=222.5,THREF_READ(46)=269.9781,
      # ZNREF_READ(47)=227.5,THREF_READ(47)=270.0002,
      # ZNREF_READ(48)=232.5,THREF_READ(48)=270.0212,
      # ZNREF_READ(49)=237.5,THREF_READ(49)=270.0413,
      # ZNREF_READ(50)=242.5,THREF_READ(50)=270.0603,
      # ZNREF_READ(51)=247.5,THREF_READ(51)=270.0784,
      # ZNREF_READ(52)=252.5,THREF_READ(52)=270.0955,
      # ZNREF_READ(53)=257.5,THREF_READ(53)=270.1117,
      # ZNREF_READ(54)=262.5,THREF_READ(54)=270.127,
      # ZNREF_READ(55)=267.5,THREF_READ(55)=270.1414,
      # ZNREF_READ(56)=272.5,THREF_READ(56)=270.1551,
      # ZNREF_READ(57)=277.5,THREF_READ(57)=270.1681,
      # ZNREF_READ(58)=282.5,THREF_READ(58)=270.1805,
      # ZNREF_READ(59)=287.5,THREF_READ(59)=270.1923,
      # ZNREF_READ(60)=292.5,THREF_READ(60)=270.2036,
      # ZNREF_READ(61)=297.5,THREF_READ(61)=270.2145,
      # ZNREF_READ(62)=302.5,THREF_READ(62)=270.225,
      # ZNREF_READ(63)=307.5,THREF_READ(63)=270.2353,
      # ZNREF_READ(64)=312.5,THREF_READ(64)=270.2454,
      # ZNREF_READ(65)=317.5,THREF_READ(65)=270.2553,
      # ZNREF_READ(66)=322.5,THREF_READ(66)=270.2652,
      # ZNREF_READ(67)=327.5,THREF_READ(67)=270.275,
      # ZNREF_READ(68)=332.5,THREF_READ(68)=270.2848,
      # ZNREF_READ(69)=337.5,THREF_READ(69)=270.2947,
      # ZNREF_READ(70)=342.5,THREF_READ(70)=270.3047,
      # ZNREF_READ(71)=347.5,THREF_READ(71)=270.3148,
      # ZNREF_READ(72)=352.5,THREF_READ(72)=270.325,
      # ZNREF_READ(73)=357.5,THREF_READ(73)=270.3354,
      # ZNREF_READ(74)=362.5,THREF_READ(74)=270.346,
      # ZNREF_READ(75)=367.5,THREF_READ(75)=270.3569,
      # ZNREF_READ(76)=372.5,THREF_READ(76)=270.3679,
      # ZNREF_READ(77)=377.5,THREF_READ(77)=270.3792,
      # ZNREF_READ(78)=382.5,THREF_READ(78)=270.3907,
      # ZNREF_READ(79)=387.5,THREF_READ(79)=270.4025,
      # ZNREF_READ(80)=392.5,THREF_READ(80)=270.4145,
      # ZNREF_READ(81)=397.5,THREF_READ(81)=270.4267,
      # ZNREF_READ(82)=402.5,THREF_READ(82)=270.4393,
      # ZNREF_READ(83)=407.5,THREF_READ(83)=270.4521,
      # ZNREF_READ(84)=412.5,THREF_READ(84)=270.4652,
      # ZNREF_READ(85)=417.5,THREF_READ(85)=270.4787,
      # ZNREF_READ(86)=422.5,THREF_READ(86)=270.4924,
      # ZNREF_READ(87)=427.5,THREF_READ(87)=270.5065,
      # ZNREF_READ(88)=432.5,THREF_READ(88)=270.521,
      # ZNREF_READ(89)=437.5,THREF_READ(89)=270.5359,
      # ZNREF_READ(90)=442.5,THREF_READ(90)=270.5513,
      # ZNREF_READ(91)=447.5,THREF_READ(91)=270.5672,
      # ZNREF_READ(92)=452.5,THREF_READ(92)=270.5837,
      # ZNREF_READ(93)=457.5,THREF_READ(93)=270.6007,
      # ZNREF_READ(94)=462.5,THREF_READ(94)=270.6185,
      # ZNREF_READ(95)=467.5,THREF_READ(95)=270.6371,
      # ZNREF_READ(96)=472.5,THREF_READ(96)=270.6565,
      # ZNREF_READ(97)=477.5,THREF_READ(97)=270.6768,
      # ZNREF_READ(98)=482.5,THREF_READ(98)=270.6982,
      # ZNREF_READ(99)=487.5,THREF_READ(99)=270.7208,
      # ZNREF_READ(100)=492.5,THREF_READ(100)=270.7446,
      # ZNREF_READ(101)=497.5,THREF_READ(101)=270.7697,
      # ZNREF_READ(102)=502.5,THREF_READ(102)=270.7963,
      # ZNREF_READ(103)=507.5,THREF_READ(103)=270.8246,
      # ZNREF_READ(104)=512.5,THREF_READ(104)=270.8545,
      # ZNREF_READ(105)=517.5,THREF_READ(105)=270.8863,
      # ZNREF_READ(106)=522.5,THREF_READ(106)=270.9199,
      # ZNREF_READ(107)=527.5,THREF_READ(107)=270.9557,
      # ZNREF_READ(108)=532.5,THREF_READ(108)=270.9936,
      # ZNREF_READ(109)=537.5,THREF_READ(109)=271.0337,
      # ZNREF_READ(110)=542.5,THREF_READ(110)=271.0762,
      # ZNREF_READ(111)=547.5,THREF_READ(111)=271.1211,
      # ZNREF_READ(112)=552.5,THREF_READ(112)=271.1684,
      # ZNREF_READ(113)=557.5,THREF_READ(113)=271.2183,
      # ZNREF_READ(114)=562.5,THREF_READ(114)=271.2708,
      # ZNREF_READ(115)=567.5,THREF_READ(115)=271.3259,
      # ZNREF_READ(116)=572.5,THREF_READ(116)=271.3835,
      # ZNREF_READ(117)=577.5,THREF_READ(117)=271.4438,
      # ZNREF_READ(118)=582.5,THREF_READ(118)=271.5067,
      # ZNREF_READ(119)=587.5,THREF_READ(119)=271.5721,
      # ZNREF_READ(120)=592.5,THREF_READ(120)=271.64,
      # ZNREF_READ(121)=597.5,THREF_READ(121)=271.7104,
      # ZNREF_READ(122)=602.5,THREF_READ(122)=271.7831,
      # ZNREF_READ(123)=607.5,THREF_READ(123)=271.858,
      # ZNREF_READ(124)=612.5,THREF_READ(124)=271.9351,
      # ZNREF_READ(125)=617.5,THREF_READ(125)=272.0143,
      # ZNREF_READ(126)=622.5,THREF_READ(126)=272.0953,
      # ZNREF_READ(127)=627.5,THREF_READ(127)=272.1782,
      # ZNREF_READ(128)=632.5,THREF_READ(128)=272.2628,
      # ZNREF_READ(129)=637.5,THREF_READ(129)=272.3489,
      # ZNREF_READ(130)=642.5,THREF_READ(130)=272.4364,
      # ZNREF_READ(131)=647.5,THREF_READ(131)=272.5251,
      # ZNREF_READ(132)=652.5,THREF_READ(132)=272.6151,
      # ZNREF_READ(133)=657.5,THREF_READ(133)=272.706,
      # ZNREF_READ(134)=662.5,THREF_READ(134)=272.7978,
      # ZNREF_READ(135)=667.5,THREF_READ(135)=272.8905,
      # ZNREF_READ(136)=672.5,THREF_READ(136)=272.9837,
      # ZNREF_READ(137)=677.5,THREF_READ(137)=273.0776,
      # ZNREF_READ(138)=682.5,THREF_READ(138)=273.1719,
      # ZNREF_READ(139)=687.5,THREF_READ(139)=273.2666,
      # ZNREF_READ(140)=692.5,THREF_READ(140)=273.3617,
      # ZNREF_READ(141)=697.5,THREF_READ(141)=273.4569,
      # ZNREF_READ(142)=702.5,THREF_READ(142)=273.5524,
      # ZNREF_READ(143)=707.5,THREF_READ(143)=273.6479,
      # ZNREF_READ(144)=712.5,THREF_READ(144)=273.7436,
      # ZNREF_READ(145)=717.5,THREF_READ(145)=273.8393,
      # ZNREF_READ(146)=722.5,THREF_READ(146)=273.935,
      # ZNREF_READ(147)=727.5,THREF_READ(147)=274.0306,
      # ZNREF_READ(148)=732.5,THREF_READ(148)=274.1262,
      # ZNREF_READ(149)=737.5,THREF_READ(149)=274.2218,
      # ZNREF_READ(150)=742.5,THREF_READ(150)=274.3173,
      # ZNREF_READ(151)=747.5,THREF_READ(151)=274.4127,
      # ZNREF_READ(152)=752.5,THREF_READ(152)=274.508,
      # ZNREF_READ(153)=757.5,THREF_READ(153)=274.6032,
      # ZNREF_READ(154)=762.5,THREF_READ(154)=274.6983,
      # ZNREF_READ(155)=767.5,THREF_READ(155)=274.7933,
      # ZNREF_READ(156)=772.5,THREF_READ(156)=274.8881,
      # ZNREF_READ(157)=777.5,THREF_READ(157)=274.9829,
      # ZNREF_READ(158)=782.5,THREF_READ(158)=275.0776,
      # ZNREF_READ(159)=787.5,THREF_READ(159)=275.1722,
      # ZNREF_READ(160)=792.5,THREF_READ(160)=275.2667,
      # ZNREF_READ(161)=797.5,THREF_READ(161)=275.3611,
      # ZNREF_READ(162)=802.5,THREF_READ(162)=275.4554,
      # ZNREF_READ(163)=807.5,THREF_READ(163)=275.5496,
      # ZNREF_READ(164)=812.5,THREF_READ(164)=275.6437,
      # ZNREF_READ(165)=817.5,THREF_READ(165)=275.7377,
      # ZNREF_READ(166)=822.5,THREF_READ(166)=275.8317,
      # ZNREF_READ(167)=827.5,THREF_READ(167)=275.9255,
      # ZNREF_READ(168)=832.5,THREF_READ(168)=276.0193,
      # ZNREF_READ(169)=837.5,THREF_READ(169)=276.113,
      # ZNREF_READ(170)=842.5,THREF_READ(170)=276.2067,
      # ZNREF_READ(171)=847.5,THREF_READ(171)=276.3002,
      # ZNREF_READ(172)=852.5,THREF_READ(172)=276.3937,
      # ZNREF_READ(173)=857.5,THREF_READ(173)=276.4871,
      # ZNREF_READ(174)=862.5,THREF_READ(174)=276.5804,
      # ZNREF_READ(175)=867.5,THREF_READ(175)=276.6737,
      # ZNREF_READ(176)=872.5,THREF_READ(176)=276.7668,
      # ZNREF_READ(177)=877.5,THREF_READ(177)=276.8599,
      # ZNREF_READ(178)=882.5,THREF_READ(178)=276.9529,
      # ZNREF_READ(179)=887.5,THREF_READ(179)=277.0459,
      # ZNREF_READ(180)=892.5,THREF_READ(180)=277.1388,
      # ZNREF_READ(181)=897.5,THREF_READ(181)=277.2316,
      # ZNREF_READ(182)=902.5,THREF_READ(182)=277.3243,
      # ZNREF_READ(183)=907.5,THREF_READ(183)=277.417,
      # ZNREF_READ(184)=912.5,THREF_READ(184)=277.5096,
      # ZNREF_READ(185)=917.5,THREF_READ(185)=277.6021,
      # ZNREF_READ(186)=922.5,THREF_READ(186)=277.6945,
      # ZNREF_READ(187)=927.5,THREF_READ(187)=277.7869,
      # ZNREF_READ(188)=932.5,THREF_READ(188)=277.8792,
      # ZNREF_READ(189)=937.5,THREF_READ(189)=277.9714,
      # ZNREF_READ(190)=942.5,THREF_READ(190)=278.0636,
      # ZNREF_READ(191)=947.5,THREF_READ(191)=278.1556,
      # ZNREF_READ(192)=952.5,THREF_READ(192)=278.2477,
      # ZNREF_READ(193)=957.5,THREF_READ(193)=278.3396,
      # ZNREF_READ(194)=962.5,THREF_READ(194)=278.4315,
      # ZNREF_READ(195)=967.5,THREF_READ(195)=278.5232,
      # ZNREF_READ(196)=972.5,THREF_READ(196)=278.615,
      # ZNREF_READ(197)=977.5,THREF_READ(197)=278.7066,
      # ZNREF_READ(198)=982.5,THREF_READ(198)=278.7982,
      # ZNREF_READ(199)=987.5,THREF_READ(199)=278.8897,
      # ZNREF_READ(200)=992.5,THREF_READ(200)=278.9811,
      # ZNREF_READ(201)=997.5,THREF_READ(201)=279.0724,
      # ZNREF_READ(202)=1002.5,THREF_READ(202)=279.1637,
      # ZNREF_READ(203)=1007.5,THREF_READ(203)=279.2549,
      # ZNREF_READ(204)=1012.5,THREF_READ(204)=279.346,
      # ZNREF_READ(205)=1017.5,THREF_READ(205)=279.437,
      # ZNREF_READ(206)=1022.5,THREF_READ(206)=279.5279,
      # ZNREF_READ(207)=1027.5,THREF_READ(207)=279.6187,
      # ZNREF_READ(208)=1032.5,THREF_READ(208)=279.7095,
      # ZNREF_READ(209)=1037.5,THREF_READ(209)=279.8001,
      # ZNREF_READ(210)=1042.5,THREF_READ(210)=279.8907,
      # ZNREF_READ(211)=1047.5,THREF_READ(211)=279.9811,
      # ZNREF_READ(212)=1052.5,THREF_READ(212)=280.0714,
      # ZNREF_READ(213)=1057.5,THREF_READ(213)=280.1616,
      # ZNREF_READ(214)=1062.5,THREF_READ(214)=280.2517,
      # ZNREF_READ(215)=1067.5,THREF_READ(215)=280.3417,
      # ZNREF_READ(216)=1072.5,THREF_READ(216)=280.4315,
      # ZNREF_READ(217)=1077.5,THREF_READ(217)=280.5211,
      # ZNREF_READ(218)=1082.5,THREF_READ(218)=280.6106,
      # ZNREF_READ(219)=1087.5,THREF_READ(219)=280.7,
      # ZNREF_READ(220)=1092.5,THREF_READ(220)=280.7891,
      # ZNREF_READ(221)=1097.5,THREF_READ(221)=280.8781,
      # ZNREF_READ(222)=1102.5,THREF_READ(222)=280.9668,
      # ZNREF_READ(223)=1107.5,THREF_READ(223)=281.0554,
      # ZNREF_READ(224)=1112.5,THREF_READ(224)=281.1437,
      # ZNREF_READ(225)=1117.5,THREF_READ(225)=281.2318,
      # ZNREF_READ(226)=1122.5,THREF_READ(226)=281.3197,
      # ZNREF_READ(227)=1127.5,THREF_READ(227)=281.4073,
      # ZNREF_READ(228)=1132.5,THREF_READ(228)=281.4947,
      # ZNREF_READ(229)=1137.5,THREF_READ(229)=281.5817,
      # ZNREF_READ(230)=1142.5,THREF_READ(230)=281.6685,
      # ZNREF_READ(231)=1147.5,THREF_READ(231)=281.755,
      # ZNREF_READ(232)=1152.5,THREF_READ(232)=281.8412,
      # ZNREF_READ(233)=1157.5,THREF_READ(233)=281.9272,
      # ZNREF_READ(234)=1162.5002,THREF_READ(234)=282.0128,
      # ZNREF_READ(235)=1167.5026,THREF_READ(235)=282.0981,
      # ZNREF_READ(236)=1172.5162,THREF_READ(236)=282.1831,
      # ZNREF_READ(237)=1177.5726,THREF_READ(237)=282.2678,
      # ZNREF_READ(238)=1182.7501,THREF_READ(238)=282.3522,
      # ZNREF_READ(239)=1188.1971,THREF_READ(239)=282.4363,
      # ZNREF_READ(240)=1194.1285,THREF_READ(240)=282.5201,
      # ZNREF_READ(241)=1200.77,THREF_READ(241)=282.6036,
      # ZNREF_READ(242)=1208.27,THREF_READ(242)=282.6868,
      # ZNREF_READ(243)=1216.6285,THREF_READ(243)=282.7698,
      # ZNREF_READ(244)=1225.6971,THREF_READ(244)=282.8524,
      # ZNREF_READ(245)=1235.2501,THREF_READ(245)=282.9349,
      # ZNREF_READ(246)=1245.0726,THREF_READ(246)=283.0171,
      # ZNREF_READ(247)=1255.0162,THREF_READ(247)=283.099,
      # ZNREF_READ(248)=1265.0026,THREF_READ(248)=283.1808,
      # ZNREF_READ(249)=1275.0002,THREF_READ(249)=283.2623,
      # ZNREF_READ(250)=1285,THREF_READ(250)=283.3436,
      # ZNREF_READ(251)=1295,THREF_READ(251)=283.4248,
      # ZNREF_READ(252)=1305,THREF_READ(252)=283.5058,
      # ZNREF_READ(253)=1315,THREF_READ(253)=283.5866,
      # ZNREF_READ(254)=1325,THREF_READ(254)=283.6673,
      # ZNREF_READ(255)=1335,THREF_READ(255)=283.7478,
      # ZNREF_READ(256)=1345,THREF_READ(256)=283.8282,
      # ZNREF_READ(257)=1355,THREF_READ(257)=283.9085,
      # ZNREF_READ(258)=1365,THREF_READ(258)=283.9886,
      # ZNREF_READ(259)=1375,THREF_READ(259)=284.0687,
      # ZNREF_READ(260)=1385,THREF_READ(260)=284.1486,
      # ZNREF_READ(261)=1395,THREF_READ(261)=284.2285,
      # ZNREF_READ(262)=1405,THREF_READ(262)=284.3083,
      # ZNREF_READ(263)=1415,THREF_READ(263)=284.3879,
      # ZNREF_READ(264)=1425,THREF_READ(264)=284.4675,
      # ZNREF_READ(265)=1435,THREF_READ(265)=284.547,
      # ZNREF_READ(266)=1445,THREF_READ(266)=284.6265,
      # ZNREF_READ(267)=1455,THREF_READ(267)=284.7058,
      # ZNREF_READ(268)=1465,THREF_READ(268)=284.7851,
      # ZNREF_READ(269)=1475,THREF_READ(269)=284.8643,
      # ZNREF_READ(270)=1485,THREF_READ(270)=284.9434,
      # ZNREF_READ(271)=1495,THREF_READ(271)=285.0224,
      # ZNREF_READ(272)=1505,THREF_READ(272)=285.1014,
      # ZNREF_READ(273)=1515,THREF_READ(273)=285.1803,
      # ZNREF_READ(274)=1525,THREF_READ(274)=285.2591,
      # ZNREF_READ(275)=1535,THREF_READ(275)=285.3378,
      # ZNREF_READ(276)=1545,THREF_READ(276)=285.4164,
      # ZNREF_READ(277)=1555,THREF_READ(277)=285.495,
      # ZNREF_READ(278)=1565,THREF_READ(278)=285.5735,
      # ZNREF_READ(279)=1575,THREF_READ(279)=285.6519,
      # ZNREF_READ(280)=1585,THREF_READ(280)=285.7302,
      # ZNREF_READ(281)=1595,THREF_READ(281)=285.8084,
      # ZNREF_READ(282)=1605,THREF_READ(282)=285.8865,
      # ZNREF_READ(283)=1615,THREF_READ(283)=285.9645,
      # ZNREF_READ(284)=1625,THREF_READ(284)=286.0425,
      # ZNREF_READ(285)=1635,THREF_READ(285)=286.1204,
      # ZNREF_READ(286)=1645,THREF_READ(286)=286.1982,
      # ZNREF_READ(287)=1655,THREF_READ(287)=286.2758,
      # ZNREF_READ(288)=1665,THREF_READ(288)=286.3534,
      # ZNREF_READ(289)=1675,THREF_READ(289)=286.431,
      # ZNREF_READ(290)=1685,THREF_READ(290)=286.5084,
      # ZNREF_READ(291)=1695,THREF_READ(291)=286.5857,
      # ZNREF_READ(292)=1705,THREF_READ(292)=286.663,
      # ZNREF_READ(293)=1715,THREF_READ(293)=286.7401,
      # ZNREF_READ(294)=1725,THREF_READ(294)=286.8172,
      # ZNREF_READ(295)=1735,THREF_READ(295)=286.8942,
      # ZNREF_READ(296)=1745,THREF_READ(296)=286.9711,
      # ZNREF_READ(297)=1755,THREF_READ(297)=287.0479,
      # ZNREF_READ(298)=1765,THREF_READ(298)=287.1246,
      # ZNREF_READ(299)=1775,THREF_READ(299)=287.2012,
      # ZNREF_READ(300)=1785,THREF_READ(300)=287.2777,
      # ZNREF_READ(301)=1795,THREF_READ(301)=287.3542,
      # ZNREF_READ(302)=1805,THREF_READ(302)=287.4305,
      # ZNREF_READ(303)=1815,THREF_READ(303)=287.5068,
      # ZNREF_READ(304)=1825,THREF_READ(304)=287.583,
      # ZNREF_READ(305)=1835,THREF_READ(305)=287.6591,
      # ZNREF_READ(306)=1845,THREF_READ(306)=287.7351,
      # ZNREF_READ(307)=1855,THREF_READ(307)=287.811,
      # ZNREF_READ(308)=1865,THREF_READ(308)=287.8868,
      # ZNREF_READ(309)=1875,THREF_READ(309)=287.9626,
      # ZNREF_READ(310)=1885,THREF_READ(310)=288.0382,
      # ZNREF_READ(311)=1895,THREF_READ(311)=288.1138,
      # ZNREF_READ(312)=1905,THREF_READ(312)=288.1893,
      # ZNREF_READ(313)=1915,THREF_READ(313)=288.2646,
      # ZNREF_READ(314)=1925,THREF_READ(314)=288.34,
      # ZNREF_READ(315)=1935,THREF_READ(315)=288.4152,
      # ZNREF_READ(316)=1945,THREF_READ(316)=288.4903,
      # ZNREF_READ(317)=1955,THREF_READ(317)=288.5653,
      # ZNREF_READ(318)=1965,THREF_READ(318)=288.6403,
      # ZNREF_READ(319)=1975,THREF_READ(319)=288.7152,
      # ZNREF_READ(320)=1985,THREF_READ(320)=288.7899,
      # ZNREF_READ(321)=1995,THREF_READ(321)=288.8646,
      # ZNREF_READ(322)=2005,THREF_READ(322)=288.9392,
      # ZNREF_READ(323)=2015,THREF_READ(323)=289.0138,
      # ZNREF_READ(324)=2025,THREF_READ(324)=289.0882,
      # ZNREF_READ(325)=2035,THREF_READ(325)=289.1626,
      # ZNREF_READ(326)=2045,THREF_READ(326)=289.2368,
      # ZNREF_READ(327)=2055,THREF_READ(327)=289.311,
      # ZNREF_READ(328)=2065,THREF_READ(328)=289.3851,
      # ZNREF_READ(329)=2075,THREF_READ(329)=289.4591,
      # ZNREF_READ(330)=2085,THREF_READ(330)=289.5331,
      # ZNREF_READ(331)=2095,THREF_READ(331)=289.6069,
      # ZNREF_READ(332)=2105,THREF_READ(332)=289.6807,
      # ZNREF_READ(333)=2115,THREF_READ(333)=289.7544,
      # ZNREF_READ(334)=2125,THREF_READ(334)=289.828,
      # ZNREF_READ(335)=2135,THREF_READ(335)=289.9015,
      # ZNREF_READ(336)=2145,THREF_READ(336)=289.9749,
      # ZNREF_READ(337)=2155,THREF_READ(337)=290.0483,
      # ZNREF_READ(338)=2165,THREF_READ(338)=290.1216,
      # ZNREF_READ(339)=2175,THREF_READ(339)=290.1948,
      # ZNREF_READ(340)=2185,THREF_READ(340)=290.2679,
      # ZNREF_READ(341)=2195,THREF_READ(341)=290.341,
      # ZNREF_READ(342)=2205,THREF_READ(342)=290.414,
      # ZNREF_READ(343)=2215,THREF_READ(343)=290.4869,
      # ZNREF_READ(344)=2225,THREF_READ(344)=290.5598,
      # ZNREF_READ(345)=2235,THREF_READ(345)=290.6326,
      # ZNREF_READ(346)=2245,THREF_READ(346)=290.7053,
      # ZNREF_READ(347)=2255,THREF_READ(347)=290.778,
      # ZNREF_READ(348)=2265,THREF_READ(348)=290.8506,
      # ZNREF_READ(349)=2275,THREF_READ(349)=290.9232,
      # ZNREF_READ(350)=2285,THREF_READ(350)=290.9957,
      # ZNREF_READ(351)=2295,THREF_READ(351)=291.0682,
      # ZNREF_READ(352)=2305,THREF_READ(352)=291.1406,
      # ZNREF_READ(353)=2315,THREF_READ(353)=291.213,
      # ZNREF_READ(354)=2325,THREF_READ(354)=291.2853,
      # ZNREF_READ(355)=2335,THREF_READ(355)=291.3576,
      # ZNREF_READ(356)=2345,THREF_READ(356)=291.4299,
      # ZNREF_READ(357)=2355,THREF_READ(357)=291.5022,
      # ZNREF_READ(358)=2365,THREF_READ(358)=291.5744,
      # ZNREF_READ(359)=2375,THREF_READ(359)=291.6466,
      # ZNREF_READ(360)=2385,THREF_READ(360)=291.7189,
      # ZNREF_READ(361)=2395,THREF_READ(361)=291.7911,


     #### dz is 5m between 0 and 1157.5 m, then linearly interpolated to 10m between 1285m and 2395m
    data['ascos1'] = {}
    data['ascos1']['z'] = np.zeros(361)
    data['ascos1']['z'][1:233] = np.arange(2.5,1157.6,5.0)
    data['ascos1']['z'][233:249] = np.array([1162.5002, 1167.5026, 1172.5162, 1177.5726, 1182.7501,
                            1188.1971, 1194.1285, 1200.77, 1208.27, 1216.6285, 1225.6971, 1235.2501, 1245.0726,
                            1255.0162, 1265.0026, 1275.0002])
    data['ascos1']['z'][249:] = np.arange(1285., 2396., 10.0)

    data['ascos1']['th'] = np.array([269.2,269.2029,269.2059,269.209,269.2124,269.216,
                            269.22,269.2244,269.2293,269.2348,269.241,269.2479,269.2556,
                            269.2642,269.2736,269.2841,269.2956,269.3083,269.322,269.3369,
                            269.3531,269.3704,269.3889,269.4086,269.4295,269.4514,269.4745,
                            269.4986,269.5235,269.5493,269.5759,269.603,269.6307,269.6587,
                            269.687,269.7154,269.7437,269.7719,269.7998,269.8273,269.8543,
                            269.8807,269.9063,269.9311,269.9551,269.9781,270.0002,270.0212,
                            270.0413,270.0603,270.0784,270.0955,270.1117,270.127,270.1414,
                            270.1551,270.1681,270.1805,270.1923,270.2036,270.2145,270.225,
                            270.2353,270.2454,270.2553,270.2652,270.275,270.2848,270.2947,
                            270.3047,270.3148,270.325,270.3354,270.346,270.3569,270.3679,
                            270.3792,270.3907,270.4025,270.4145,270.4267,270.4393,270.4521,
                            270.4652,270.4787,270.4924,270.5065,270.521,270.5359,270.5513,
                            270.5672,270.5837,270.6007,270.6185,270.6371,270.6565,270.6768,
                            270.6982,270.7208,270.7446,270.7697,270.7963,270.8246,270.8545,
                            270.8863,270.9199,270.9557,270.9936,271.0337,271.0762,271.1211,
                            271.1684,271.2183,271.2708,271.3259,271.3835,271.4438,271.5067,
                            271.5721,271.64,271.7104,271.7831,271.858,271.9351,272.0143,
                            272.0953,272.1782,272.2628,272.3489,272.4364,272.5251,272.6151,
                            272.706,272.7978,272.8905,272.9837,273.0776,273.1719,273.2666,
                            273.3617,273.4569,273.5524,273.6479,273.7436,273.8393,273.935,
                            274.0306,274.1262,274.2218,274.3173,274.4127,274.508,274.6032,
                            274.6983,274.7933,274.8881,274.9829,275.0776,275.1722,275.2667,
                            275.3611,275.4554,275.5496,275.6437,275.7377,275.8317,275.9255,
                            276.0193,276.113,276.2067,276.3002,276.3937,276.4871,276.5804,
                            276.6737,276.7668,276.8599,276.9529,277.0459,277.1388,277.2316,
                            277.3243,277.417,277.5096,277.6021,277.6945,277.7869,277.8792,
                            277.9714,278.0636,278.1556,278.2477,278.3396,278.4315,278.5232,
                            278.615,278.7066,278.7982,278.8897,278.9811,279.0724,279.1637,
                            279.2549,279.346,279.437,279.5279,279.6187,279.7095,279.8001,
                            279.8907,279.9811,280.0714,280.1616,280.2517,280.3417,280.4315,
                            280.5211,280.6106,280.7,280.7891,280.8781,280.9668,281.0554,281.1437,
                            281.2318,281.3197,281.4073,281.4947,281.5817,281.6685,281.755,
                            281.8412,281.9272,282.0128,282.0981,282.1831,282.2678,282.3522,
                            282.4363,282.5201,282.6036,282.6868,282.7698,282.8524,282.9349,
                            283.0171,283.099,283.1808,283.2623,283.3436,283.4248,283.5058,
                            283.5866,283.6673,283.7478,283.8282,283.9085,283.9886,284.0687,
                            284.1486,284.2285,284.3083,284.3879,284.4675,284.547,284.6265,
                            284.7058,284.7851,284.8643,284.9434,285.0224,285.1014,285.1803,
                            285.2591,285.3378,285.4164,285.495,285.5735,285.6519,285.7302,
                            285.8084,285.8865,285.9645,286.0425,286.1204,286.1982,286.2758,
                            286.3534,286.431,286.5084,286.5857,286.663,286.7401,286.8172,
                            286.8942,286.9711,287.0479,287.1246,287.2012,287.2777,287.3542,
                            287.4305,287.5068,287.583,287.6591,287.7351,287.811,287.8868,
                            287.9626,288.0382,288.1138,288.1893,288.2646,288.34,288.4152,
                            288.4903,288.5653,288.6403,288.7152,288.7899,288.8646,288.9392,
                            289.0138,289.0882,289.1626,289.2368,289.311,289.3851,289.4591,
                            289.5331,289.6069,289.6807,289.7544,289.828,289.9015,289.9749,
                            290.0483,290.1216,290.1948,290.2679,290.341,290.414,290.4869,
                            290.5598,290.6326,290.7053,290.778,290.8506,290.9232,290.9957,
                            291.0682,291.1406,291.213,291.2853,291.3576,291.4299,291.5022,
                            291.5744,291.6466,291.7189,291.7911])


    SMALL_SIZE = 12
    MED_SIZE = 14
    LARGE_SIZE = 16

    plt.rc('font',size=MED_SIZE)
    plt.rc('axes',titlesize=MED_SIZE)
    plt.rc('axes',labelsize=MED_SIZE)
    plt.rc('xtick',labelsize=MED_SIZE)
    plt.rc('ytick',labelsize=MED_SIZE)
    plt.figure(figsize=(4,5))
    plt.rc('legend',fontsize=MED_SIZE)
    plt.subplots_adjust(top = 0.9, bottom = 0.12, right = 0.95, left = 0.25,
            hspace = 0.22, wspace = 0.4)

    yylim = 2.4e3

    plt.plot(data['ascos1']['th'], data['ascos1']['z'])
    plt.ylabel('Z [m]')
    plt.xlabel('$\Theta$ [K]')
    plt.ylim([0,yylim])
    # plt.xlim([265,276])

    plt.savefig('../FIGS/Quicklooks_LEM-ASCOS1_' + sondenumber + '.png')
    plt.show()


def main():

    START_TIME = time.time()
    print ('******')
    print ('')
    print ('Start: ' + time.strftime("%c"))
    print ('')

    '''
    Python script to build initialisation data for MONC from radiosondes
    '''

    print ('Import ASCOS radiosonde data:')
    print ('...')

    print ('Load radiosonde data from Jutta...')
    sondes = readMatlabData('../DATA/radiosondes.mat')

    print ('')
    # print (sondes.keys())

    ## -------------------------------------------------------------
    ## Load radiosonde from 20180827 1200UTC (as in Tom's work)
    ## -------------------------------------------------------------
    data = {}
    sondenumber = 'X080827_12_EDT'
    data['sonde'] = sondes[sondenumber]

    ## -------------------------------------------------------------
    ## Quicklook plots of chosen sonde
    ## -------------------------------------------------------------
    figure = quicklooksSonde(data, sondenumber)

    ## -------------------------------------------------------------
    ## Read in data from LEM namelists
    ## -------------------------------------------------------------
    figure = LEM_Load(data, sondenumber)

    ## -------------------------------------------------------------
    ## save out working data for testing
    ## -------------------------------------------------------------
    np.save('working_data', data)

    # -------------------------------------------------------------
    # FIN.
    # -------------------------------------------------------------
    END_TIME = time.time()
    print ('******')
    print ('')
    print ('End: ' + time.strftime("%c"))
    print ('')


if __name__ == '__main__':

    main()
