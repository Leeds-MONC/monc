<data-definition name="profile_timeseries_fields" frequency="{sampling_frequency}" namespace="profile_fields">
  <field name="prefn_local" type="array" data_type="double" optional=true />
  <field name="rho_local" type="array" data_type="double" optional=true />
  <field name="rhon_local" type="array" data_type="double" optional=true />
  <field name="thinit_local" type="array" data_type="double" optional=true />
  <field name="thref_local" type="array" data_type="double" optional=true />
  <field name="u_wind_total_local" type="array" data_type="double" optional=true/>
  <field name="v_wind_total_local" type="array" data_type="double" optional=true/>
  <field name="w_wind_total_local" type="array" data_type="double" optional=true/>
  <field name="uu_total_local" type="array" data_type="double" optional=true/>
  <field name="vv_total_local" type="array" data_type="double" optional=true/>
  <field name="ww_total_local" type="array" data_type="double" optional=true/>
  <field name="theta_total_local" type="array" data_type="double" optional=true/>
  <field name="vapour_mmr_total_local" type="array" data_type="double" optional=true/>
  <field name="liquid_mmr_total_local" type="array" data_type="double" optional=true/>
  <field name="uw_total_local" type="array" data_type="double" optional=true/>
  <field name="vw_total_local" type="array" data_type="double" optional=true/>
  <field name="wtheta_total_local" type="array" data_type="double" optional=true/>
  <field name="th2_total_local" type="array" data_type="double" optional=true/>
  <field name="uwsg_total_local" type="array" data_type="double" optional=true/>
  <field name="vwsg_total_local" type="array" data_type="double" optional=true/>
  <field name="uusg_total_local" type="array" data_type="double" optional=true/>
  <field name="vvsg_total_local" type="array" data_type="double" optional=true/>
  <field name="wwsg_total_local" type="array" data_type="double" optional=true/>
  <field name="tkesg_total_local" type="array" data_type="double" optional=true/>
  <field name="wtsg_total_local" type="array" data_type="double" optional=true/>
  <field name="th2sg_total_local" type="array" data_type="double" optional=true/>
  <field name="u_large_scale" type="array" data_type="double" optional=true />
  <field name="th_large_scale" type="array" data_type="double" optional=true />
  <field name="rh_total_local" type="array" data_type="double" optional=true/>
</data-definition>

<data-handling namespace="profile_fields">
   <diagnostic field="prefn"  type="array" data_type="double" size="zn">
	<communication name="reduction" operator="mean" result="prefn" field="prefn_local" root="auto"/>
   </diagnostic>
   <diagnostic field="rho"  type="array" data_type="double" size="z">
	<communication name="reduction" operator="mean" result="rho" field="rho_local" root="auto"/>
   </diagnostic>  
   <diagnostic field="rhon"  type="array" data_type="double" size="zn">
	<communication name="reduction" operator="mean" result="rhon" field="rhon_local" root="auto"/>
   </diagnostic>
   <diagnostic field="thinit"  type="array" data_type="double" size="zn">
	<communication name="reduction" operator="mean" result="thinit" field="thinit_local" root="auto"/>
  </diagnostic>
   <diagnostic field="thref"  type="array" data_type="double" size="zn">
	<communication name="reduction" operator="mean" result="thref" field="thref_local" root="auto"/>
  </diagnostic>  
  <diagnostic field="u_wind_mean"  type="array" data_type="double" size="zn">
	<operator name="arithmetic" result="u_wind_mean" equation="u_wind_mean_g/({x_size}*{y_size})" units="1" description="divided by domain xy-cell-count"/>
	<communication name="reduction" operator="sum" result="u_wind_mean_g" field="u_wind_total_local" root="auto"/>
  </diagnostic> 
  <diagnostic field="v_wind_mean"  type="array" data_type="double" size="zn">
	<operator name="arithmetic" result="v_wind_mean" equation="v_wind_mean_g/({x_size}*{y_size})" units="1" description="divided by domain xy-cell-count"/>
	<communication name="reduction" operator="sum" result="v_wind_mean_g" field="v_wind_total_local" root="auto"/>
  </diagnostic>
  <diagnostic field="w_wind_mean"  type="array" data_type="double" size="z">
	<operator name="arithmetic" result="w_wind_mean" equation="w_wind_total_g/({x_size}*{y_size})" units="1" description="divided by domain xy-cell-count"/>
	<communication name="reduction" operator="sum" result="w_wind_total_g" field="w_wind_total_local" root="auto"/>
  </diagnostic>   
  <diagnostic field="uu_mean"  type="array" data_type="double" size="zn" units="m^2/s^2">
	<operator name="arithmetic" result="uu_mean" equation="uu_mean_g/({x_size}*{y_size})"/>
	<communication name="reduction" operator="sum" result="uu_mean_g" field="uu_total_local" root="auto"/>
  </diagnostic> 
  <diagnostic field="vv_mean"  type="array" data_type="double" size="zn" units="m^2/s^2">
	<operator name="arithmetic" result="vv_mean" equation="vv_mean_g/({x_size}*{y_size})"/>
	<communication name="reduction" operator="sum" result="vv_mean_g" field="vv_total_local" root="auto"/>
  </diagnostic>  
  <diagnostic field="ww_mean"  type="array" data_type="double" size="zn" units="m^2/s^2">
	<operator name="arithmetic" result="ww_mean" equation="ww_mean_g/({x_size}*{y_size})"/>
	<communication name="reduction" operator="sum" result="ww_mean_g" field="ww_total_local" root="auto"/>
  </diagnostic>  
  <diagnostic field="theta_mean"  type="array" data_type="double" size="zn">
	<operator name="arithmetic" result="theta_mean" equation="theta_mean_g/({x_size}*{y_size})" units="1" description="divided by domain xy-cell-count"/>
	<communication name="reduction" operator="sum" result="theta_mean_g" field="theta_total_local" root="auto"/>
  </diagnostic>  
  <diagnostic field="vapour_mmr_mean"  type="array" data_type="double" size="zn" units="kg/kg">
	<operator name="arithmetic" result="vapour_mmr_mean" equation="vapour_mmr_mean_g/({x_size}*{y_size})"/>
	<communication name="reduction" operator="sum" result="vapour_mmr_mean_g" field="vapour_mmr_total_local" root="auto"/>
  </diagnostic>
  <diagnostic field="liquid_mmr_mean"  type="array" data_type="double" size="zn" units="kg/kg">
    	<operator name="arithmetic" result="liquid_mmr_mean" equation="liquid_mmr_mean_g/({x_size}*{y_size})"/>
	<communication name="reduction" operator="sum" result="liquid_mmr_mean_g" field="liquid_mmr_total_local" root="auto"/>
  </diagnostic>
  <diagnostic field="uw_mean"  type="array" data_type="double" size="zn" units="m^2/s^2">
	<operator name="arithmetic" result="uw_mean" equation="uw_mean_g/({x_size}*{y_size})"/>
	<communication name="reduction" operator="sum" result="uw_mean_g" field="uw_total_local" root="auto"/>
  </diagnostic>  

  <diagnostic field="vw_mean"  type="array" data_type="double" size="zn" units="m^2/s^2">
	<operator name="arithmetic" result="vw_mean" equation="vw_mean_g/({x_size}*{y_size})"/>
	<communication name="reduction" operator="sum" result="vw_mean_g" field="vw_total_local" root="auto"/>
  </diagnostic>  

  <diagnostic field="wtheta_mean"  type="array" data_type="double" size="zn" units="Km/s">
	<operator name="arithmetic" result="wtheta_mean" equation="wtheta_mean_g/({x_size}*{y_size})"/>
	<communication name="reduction" operator="sum" result="wtheta_mean_g" field="wtheta_total_local" root="auto"/>
  </diagnostic>  

  <diagnostic field="th2_mean"  type="array" data_type="double" size="zn" units="K^2">
	<operator name="arithmetic" result="th2_mean" equation="th2_mean_g/({x_size}*{y_size})"/>
	<communication name="reduction" operator="sum" result="th2_mean_g" field="th2_total_local" root="auto"/>
  </diagnostic>  

  <diagnostic field="uwsg_mean"  type="array" data_type="double" size="zn" units="m^2/s^2">
	<operator name="arithmetic" result="uwsg_mean" equation="uwsg_mean_g/({x_size}*{y_size})"/>
	<communication name="reduction" operator="sum" result="uwsg_mean_g" field="uwsg_total_local" root="auto"/>
  </diagnostic>  

  <diagnostic field="vwsg_mean"  type="array" data_type="double" size="zn" units="m^2/s^2">
	<operator name="arithmetic" result="vwsg_mean" equation="vwsg_mean_g/({x_size}*{y_size})"/>
	<communication name="reduction" operator="sum" result="vwsg_mean_g" field="vwsg_total_local" root="auto"/>
  </diagnostic>  

  <diagnostic field="uusg_mean"  type="array" data_type="double" size="zn" units="m^2/s^2">
	<operator name="arithmetic" result="uusg_mean" equation="uusg_mean_g/({x_size}*{y_size})"/>
	<communication name="reduction" operator="sum" result="uusg_mean_g" field="uusg_total_local" root="auto"/>
  </diagnostic>  

  <diagnostic field="vvsg_mean"  type="array" data_type="double" size="zn" units="m^2/s^2">
	<operator name="arithmetic" result="vvsg_mean" equation="vvsg_mean_g/({x_size}*{y_size})"/>
	<communication name="reduction" operator="sum" result="vvsg_mean_g" field="vvsg_total_local" root="auto"/>
  </diagnostic>  

  <diagnostic field="wwsg_mean"  type="array" data_type="double" size="zn" units="m^2/s^2">
	<operator name="arithmetic" result="wwsg_mean" equation="wwsg_mean_g/({x_size}*{y_size})"/>
	<communication name="reduction" operator="sum" result="wwsg_mean_g" field="wwsg_total_local" root="auto"/>
  </diagnostic>  

  <diagnostic field="tkesg_mean"  type="array" data_type="double" size="zn" units="m^2/s^2">
	<operator name="arithmetic" result="tkesg_mean" equation="tkesg_mean_g/({x_size}*{y_size})"/>
	<communication name="reduction" operator="sum" result="tkesg_mean_g" field="tkesg_total_local" root="auto"/>
  </diagnostic>  

  <diagnostic field="wtsg_mean"  type="array" data_type="double" size="zn" units="Km/s">
	<operator name="arithmetic" result="wtsg_mean" equation="wtsg_mean_g/({x_size}*{y_size})"/>
	<communication name="reduction" operator="sum" result="wtsg_mean_g" field="wtsg_total_local" root="auto"/>
  </diagnostic>  

  <diagnostic field="th2sg_mean"  type="array" data_type="double" size="zn" units="K^2">
	<operator name="arithmetic" result="th2sg_mean" equation="th2sg_mean_g/({x_size}*{y_size})"/>
	<communication name="reduction" operator="sum" result="th2sg_mean_g" field="th2sg_total_local" root="auto"/>
  </diagnostic>  

  <diagnostic field="th_large_scale_mean"  type="array" data_type="double" size="zn" units="m/s">
	<operator name="arithmetic" result="th_large_scale_mean" equation="th_large_scale_g/({x_size}*{y_size})"/>
	<communication name="reduction" operator="sum" result="th_large_scale_g" field="th_large_scale" root="auto"/>
  </diagnostic> 
  <diagnostic field="u_large_scale_mean"  type="array" data_type="double" size="zn" units="m/s">
    <operator name="arithmetic" result="u_large_scale_mean" equation="u_large_scale_g/({x_size}*{y_size})"/>
    <communication name="reduction" operator="sum" result="u_large_scale_g" field="u_large_scale" root="auto"/>
  </diagnostic> 
  <diagnostic field="rh_mean"  type="array" data_type="double" size="zn" units="K">
     <operator name="arithmetic" result="rh_mean" equation="(rh_total_g/({x_size}*{y_size})*100)"/>
    <communication name="reduction" operator="sum" result="rh_total_g" field="rh_total_local" root="auto"/>
  </diagnostic>
</data-handling>

<group name="profile_timeseries" namespace="profile_fields">
  <member name="prefn"/>
  <member name="rho"/>
  <member name="rhon"/>
  <member name="thref"/>
  <member name="thinit"/>
  <member name="u_wind_mean"/>
  <member name="v_wind_mean"/>
  <member name="w_wind_mean"/>
  <member name="uu_mean"/>
  <member name="vv_mean"/>
  <member name="ww_mean"/>
  <member name="theta_mean"/>
  <member name="vapour_mmr_mean"/>
  <member name="liquid_mmr_mean"/> 
  <member name="uw_mean"/>
  <member name="vw_mean"/>
  <member name="wtheta_mean"/>
  <member name="th2_mean"/>
  <member name="uwsg_mean"/>
  <member name="vwsg_mean"/>
  <member name="uusg_mean"/>
  <member name="vvsg_mean"/>
  <member name="wwsg_mean"/>
  <member name="tkesg_mean"/>
  <member name="wtsg_mean"/>
  <member name="th2sg_mean"/>
  <member name="u_large_scale_mean"/>
  <member name="th_large_scale_mean"/>
  <member name="rh_mean"/>
</group>
